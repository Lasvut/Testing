======================================================================
DETAILED ACCURACY TEST - FINE-TUNED THRESHOLD SEARCH
======================================================================

Loading CSIC dataset...
✅ Loaded 1500 normal samples
✅ Loaded 750 attack samples

Training set: 1050 normal + 525 attack
Test set: 450 normal + 225 attack

Training detector with supervised learning...

[Enhanced Detector] Training on 1050 normal requests...
[Enhanced Detector] Also using 525 attack samples for supervised learning
[Enhanced Detector] Building n-gram models...
[Enhanced Detector] Calculating endpoint thresholds...
[Enhanced Detector] Training Random Forest Classifier (Supervised)...
[Enhanced Detector] ✅ Random Forest trained successfully
[Enhanced Detector]    Training set: 1050 normal + 525 attack
[Enhanced Detector] ✅ Training complete
  - Feature distributions: 38
  - Parameter whitelist: 20 params
  - Bigrams: 1086, Trigrams: 4674
  - Endpoint thresholds: 1 paths
  - ML: Random Forest with 300 trees (Supervised)

======================================================================
Fine-grained threshold search (40-84 in steps of 2)...
======================================================================

⚠️  T= 40: Acc= 76.74%  Prec= 60.69%  Rec= 85.78%  F1= 71.09%  (TP=193 FP=125 TN=325 FN=32)
⚠️  T= 42: Acc= 77.33%  Prec= 62.16%  Rec= 81.78%  F1= 70.63%  (TP=184 FP=112 TN=338 FN=41)
⚠️  T= 44: Acc= 77.04%  Prec= 63.06%  Rec= 75.11%  F1= 68.56%  (TP=169 FP=99 TN=351 FN=56)
⚠️  T= 46: Acc= 77.33%  Prec= 66.22%  Rec= 65.33%  F1= 65.77%  (TP=147 FP=75 TN=375 FN=78)
⚠️  T= 48: Acc= 77.48%  Prec= 68.53%  Rec= 60.00%  F1= 63.98%  (TP=135 FP=62 TN=388 FN=90)
⚠️  T= 50: Acc= 77.48%  Prec= 68.53%  Rec= 60.00%  F1= 63.98%  (TP=135 FP=62 TN=388 FN=90)
⚠️  T= 52: Acc= 77.48%  Prec= 68.53%  Rec= 60.00%  F1= 63.98%  (TP=135 FP=62 TN=388 FN=90)
⚠️  T= 54: Acc= 78.07%  Prec= 69.95%  Rec= 60.00%  F1= 64.59%  (TP=135 FP=58 TN=392 FN=90)
⚠️  T= 56: Acc= 78.22%  Prec= 70.31%  Rec= 60.00%  F1= 64.75%  (TP=135 FP=57 TN=393 FN=90)
⚠️  T= 58: Acc= 78.22%  Prec= 70.31%  Rec= 60.00%  F1= 64.75%  (TP=135 FP=57 TN=393 FN=90)
⚠️  T= 60: Acc= 78.22%  Prec= 70.31%  Rec= 60.00%  F1= 64.75%  (TP=135 FP=57 TN=393 FN=90)
⚠️  T= 62: Acc= 78.67%  Prec= 71.43%  Rec= 60.00%  F1= 65.22%  (TP=135 FP=54 TN=396 FN=90)
